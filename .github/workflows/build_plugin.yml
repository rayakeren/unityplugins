name: Build Apple Plugin
on: [workflow_dispatch]

jobs:
  build:
    # UPDATED: Use macOS 15 to get Xcode 16 (iOS 18 SDK)
    runs-on: macos-15
    
    steps:
      - uses: actions/checkout@v3
      
      # Keep these deletions to avoid Vision Pro errors
      - name: Remove Broken Plugins
        run: |
          rm -rf plug-ins/Apple.SpatialController
          rm -rf plug-ins/Apple.PHASE
          rm -rf plug-ins/Apple.DataCollection
      
      - name: Run Build Script
        run: python3 build.py
        
      - name: Upload Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: AppleUnityPlugins-Built
          path: Build/*.tgz
